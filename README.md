Test Task Blog
–ü—Ä–æ—Å—Ç–æ–µ –±–ª–æ–≥-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Symfony —Å REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.
üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

PHP —Å —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–º Symfony
PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
Nginx –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
Docker & Docker Compose

üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

Docker
Docker Compose

‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

bashgit clone https://github.com/–≤–∞—à-username/test_task_blog.git
cd test_task_blog

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:

bashdocker-compose up -d

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:


API: http://localhost:9000
Swagger UI: http://localhost:9000/api/doc (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

app - PHP –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Symfony (–ø–æ—Ä—Ç 9000)
nginx - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (–ø–æ—Ä—Ç 8085)
database - PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–æ—Ä—Ç 5432)

üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
httpPOST /api/login_check
–ü–æ—Å—Ç—ã
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–æ—Å—Ç—ã
httpGET /api/posts/
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç
httpPOST /api/posts/
–ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ—Å—Ç
httpGET /api/posts/{id}
–û–±–Ω–æ–≤–∏—Ç—å –ø–æ—Å—Ç
httpPUT /api/posts/{id}
–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç
httpDELETE /api/posts/{id}
–ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –∞–≤—Ç–æ—Ä–∞
httpGET /api/posts/count/{id}
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
httpGET /api/users/
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
httpPOST /api/users/
–ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
httpGET /api/users/{id}
–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
httpDELETE /api/users/{id}
üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
–ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
bash# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker-compose up -d

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs -f app

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker-compose down
–†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
bash# –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
docker-compose exec app php bin/console doctrine:migrations:migrate

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
docker-compose exec app php bin/console doctrine:migrations:generate

# –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∏–∫—Å—Ç—É—Ä—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
docker-compose exec app php bin/console doctrine:fixtures:load
–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
bash# –ó–∞–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose exec app bash

# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à Symfony
docker-compose exec app php bin/console cache:clear

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Composer
docker-compose exec app composer install

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)
docker-compose exec app php bin/phpunit
üóÉÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Docker volume –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

Host: localhost
Port: 5432
Database: symfony
Username: symfony
Password: symfony

üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–∞—Ö:

docker-compose.yml - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker —Å–µ—Ä–≤–∏—Å–æ–≤
.env - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Symfony
config/ - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Symfony

üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
bashcurl -X POST http://localhost:9000/api/users/ \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "email": "ivan@example.com"
  }'
–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
bashcurl -X POST http://localhost:9000/api/posts/ \
  -H "Content-Type: application/json" \
  -d '{
    "title": "–ú–æ–π –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç",
    "content": "–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ—Å—Ç–∞...",
    "author_id": 1
  }'
–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤
bashcurl http://localhost:9000/api/posts/
üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
–ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—Ä—Ç–∞–º–∏
–ï—Å–ª–∏ –ø–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã, –∏–∑–º–µ–Ω–∏—Ç–µ –∏—Ö –≤ docker-compose.yml:
yamlports:
  - "8080:80"  # –≤–º–µ—Å—Ç–æ 8085:80 –¥–ª—è nginx
  - "9001:9000" # –≤–º–µ—Å—Ç–æ 9000:9000 –¥–ª—è app
–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
bash# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫–∏ Symfony
sudo chown -R $USER:$USER var/ vendor/
–ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
bashdocker-compose down
docker-compose up --build
üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.
ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
1.–°–æ–∑–¥–∞–π—Ç–µ —Ñ–æ—Ä–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2.–°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
3.–í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —Å–æ–∑–¥–∞–π—Ç–µ pull request

–ö–æ–Ω—Ç–∞–∫—Ç: newmsiartem@gmail.com
